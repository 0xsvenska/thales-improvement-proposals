| id | Title | Status | Author | Description | Discussions to | Created |
| ----------- | ----------- | ----------- | ----------- | ----------- | ----------- | ----------- |
| TIP-17 | THALES L2 rollout| Draft | Danijel (@dgornjakovic) | Formalize a plan for THALES l2 rollout| https://discord.gg/8bzFdpGTrp | 2021-12-29
 
## Simple Summary
 
The TIP aims to formalize a plan on how rolling out THALES token on Optimism mainnet will be conducted. 
 
## Motivation
THALES token is currently only available on layer 1 mainnet. As most of Thales protocol volume is happening and is planned to happen on Optimism Mainnet, Thales should also offer token bridge and staking on layer 2, as well as build liquidity for its native governance token on Optimism layer 2.  
Furthermore, this TIP aims to improve Thales Staking module by offering a gamified approach to staking which rewards active protocol users.  

Per [link](https://thalesmarket.medium.com/a-part-of-thales-core-contributors-tokens-are-locked-and-its-implications-241fcec37888?source=user_profile---------6-------------------------------) we explained how a large chunk of Core Contributor tokens got locked mistakenly in a contract for 5 years. To offset for this, Thales will deploy an Exchanger contract that offer 1 to 1 exchange to a new token which is provisionally called OpTHALES and which will be bridged and supported on Optimism Mainnet.  

Thales has been rewards 125k THALES rewards to SNX users pro rata based on the SNX staking debt on a weekly level. While this number is a large portion of THALES inflation, it did not make the impact to synthetix staking that it was hoped for and due to the large TVL in SNX staking, it hardly makes a difference to an average SNX staker. This TIP proposes to reduce that total number of weekly rewards for SNX stakers, while reverting the value of that inflation to THALES staking. To achieve this SNX staking will have a significant weight in the new gamified THALES staking approach that provides a bonus to stakers based on certain parameters.    

## Specification
When all contracts are ready which is planned to be toward end of January/early February 2022. this TIP proposes the following:

1. Create a seamless Exchanger+Bridge on Ethereum mainnet that accepts THALES as input, exchanges it 1 to 1 to OpTHALES and migrates it to Optimism mainnet. The said contract also accept exchanging OpTHALES to THALES. OpTHALES will have 100m supply, identical to THALES, but 15.9m tokens that were mistakenly locked will be kept in treasury, while 85.1 million will be put into the exchanger contract, and only minted when THALES is offered in exchange 1 to 1.
2. Move all unclaimed airdrops to optimism mainnet, thus allowing those who still haven't claimed the airdrop to claim it on L2
3. Shift all pending ongoing rewards and make those claimable on Optimism Mainnet
4. Reduce the staking cooldown to 1 second (whatever is minimum) to allow a smooth migration to L2
5. Deprecate L1 staking and rollout staking on L2 where the first week will have doubled base rewards (50k to 100k THALES) to incentivize migration.
6. Deprecate ongoing rewards concept which required a centralized approach to offset for layer 1 gas costs
7. Upgrade the staking module to Thales gamified staking approach that offers up to 2x bonus on base rewards based on the specification below.  


Gamified THALES staking on Optimism Mainnet:
- Base weekly rewards of 50k THALES
- Introduce a multiplier factor with a maximum value of 2 that is calculated based on the following:  
      - 50% weight to SNX staking. If a THALES staker has at least the same debt percentage in SNX staking compared to his percentage of THALES staked from the total THALES staked he gets the maximum points here, otherwise its proportional to the debt share percentage he has in SNX staking compared to THALES staked share percentage  
      - 40% weight to AMM trading volume. If a THALES staker has at least the same AMM volume percentage in AMM trading (from the total AMM volume generated by THALES stakers) compared to his percentage of THALES staked from the total THALES staked he gets the maximum points here.  
      - 10% weight if the staker participated in the last Thales Royale. This value can be up either 0 or max.
       
      
Example:
    
  - A THALES staker has 1% of total THALES staked and is eligible for 100 THALES base rewards
  - He is also an SNX staker and his debt share is 1% from the total SNX staking debt share amongst THALES stakers. He gets maximum SNX staking bonus, so his current multiplier is 1.5x
  - His AMM trading volume is 0.5% for the total trading volume in the last staking epoch generated by THALES stakers. His multiplier here is half of the maximum AMM multiplier, so 0.2 which brings his total multiplier to 1.7x
  - He participated in the last Thales Royale so he gets additional 0.1 to multiplier thus his final multipleir is 1.8x
  - He gets 180 THALES as rewards for that staking epoch/week

On Optimism Mainnet rewards will have to be claimed weekly and be subject to same escrow rules as in the staking contract on Ethereum Mainnet.
Further improvements to staking can be formalized in additional TIPs.

## Test Cases
 
## Implementation

## Copyright
 
Copyright and related rights waived via CC0.
