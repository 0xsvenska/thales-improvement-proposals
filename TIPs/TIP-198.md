| id    | Title | Status      | Author  | Description | Discussions to | Created    |
| ----- | ----- | ----------- | ------- | ----------- | -------------- | ---------- |
| TIP-198 | Bridge OVER using CCIP | Draft | Kiril (Overtime) | Use CCIP to bridge OVER across all supported networks | [discordlink ](https://discord.gg/thales)   | 2024-03-20 |


## Simple Summary


Use Chainlink Cross-Chain Interoperability Protocol (CCIP) to bridge OVER token across all supported networks.


## Abstract

Chainlink CCIP has proven as a reliable protocol which can be used as a secure bridge along current bridging options.  
OVER token holders may benefit from lower fees without compensating security.


## Motivation

After successful implementaion of [TIP-181](https://github.com/thales-markets/thales-improvement-proposals/blob/main/TIPs/TIP-181.md), this TIP proposes the use of Chainlink CCIP to enable OVER token holders to bridge accross all supported network. The idea is to provide multiple secure bridging options for OVER token holders. Chainlink CCIP operates at the highest level of cross-chain security by taking a defense-in-depth approach, where multiple decentralized oracle networks and an independent Risk Management Network secure each transaction.  

By implementing and managing our own bridging solution, we reduce the 3rd party risk and keep the fees from bridging in house.

The implementation details are laid in the specification

## Specification

New *OvertimeBridgePool* contracts are deployed on every supported network. Each *OvertimeBridgePool* contract is pre-loaded with OVER tokens.  
A user initiates bridging of OVER tokens from origin network by depositing *X* amount of OVER to the origin *OvertimeBridgePool* and triggering a CCIP message to be sent to a destination *OvertimeBridgePool* on destination network. Upon successful CCIP messaging, the destination *OvertimeBridgePool* transfers *(X - fees)* amount of OVER to the user address on the destination network.  
In case of unsuccessful bridge operation, the funds are refunded to the user on the origin chain.  
Note: the destination address can differ from the user address and can be arbitrary chosen.

For example, if user decides to bridge from Optimism to Arbitrum network an amount of 100 OVER with 0.5% fees:

1. The user approves *OvertimeBridgePool* on Optimism.
2. The user triggers bridging function that deposits 100 OVER to the *OvertimeBridgePool* on Optimism.
3. Fee of 0.5% is applied and 0.5 OVER are stored ready to be burned.
4. The Optimism *OvertimeBridgePool* generates a CCIP message that is sent to Arbitrum *OvertimeBridgePool*.
5. The Arbitrum *OvertimeBridgePool* receives the message and obtains a destination address.
6. The Arbitrum *OvertimeBridgePool* transfers 99.5 OVER to the destination address.

If the transfer at the destination network fails (e.g. due to low OVER tokens on destination), the destination *OvertimeBridgePool* sends back a CCIP message to the origin *OvertimeBridgePool* to fully refund the user due to unsuccessful bridging.

## Test Cases

- Bridge between OP Sepolia and Arbitrum Sepolia.  
- Bridge from OP Sepolia to Arbitrum Sepolia with unsuccessful execution on destination. Refund funds back to the user on origin chain


## Implementation

- OvertimeBridgePool contract - perform cross-chain messaging and holds pool of OVER tokens.
- Fees - percentage fees for bridging, can be done dynamically as a percentage of the bridged tokens, as well as have a min and max thresholds
- min bridge amount - the minimum amount that can be bridged in a single tx
- max bridge amount - the maximum amount that can be bridged in a single tx

## Copyright

Copyright and related rights waived via CC0.
